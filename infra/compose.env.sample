# Central environment template for TREAZRISLAND stacks.
# Copy this file to `compose.env`, adjust secrets, and export TREAZ_ENV_FILE=/absolute/path/to/compose.env
# before running deployment scripts or Docker Compose. Values below are safe defaults for local and
# smoke-test deployments only; rotate them for any shared environment.

# --- Database ---------------------------------------------------------------
POSTGRES_DB=treazrisland
POSTGRES_USER=treaz_admin
POSTGRES_PASSWORD=treaz_admin_secure_pass
DATABASE_URL=postgresql://treaz_admin:treaz_admin_secure_pass@postgres:5432/treazrisland?schema=public

# --- Runtime ---------------------------------------------------------------
NODE_ENV=production
PORT=3001
LOG_LEVEL=info

# --- Authentication --------------------------------------------------------
JWT_SECRET=treaz_local_dev_secret_key_with_32_bytes
JWT_ACCESS_TTL=15m
JWT_REFRESH_TTL=30d
PASSWORD_RESET_TTL=1h
MFA_ISSUER=TREAZRISLAND
MFA_ENCRYPTION_KEY=treaz_local_dev_mfa_secret_key_32_chars
MFA_RECOVERY_CODE_COUNT=10
MFA_RECOVERY_CODE_LENGTH=10

# --- Email (set provider=postmark for real deliveries) ---------------------
EMAIL_PROVIDER=none
# POSTMARK_SERVER_TOKEN=
# POSTMARK_FROM_EMAIL=
# POSTMARK_MESSAGE_STREAM=

# --- CORS / Frontend -------------------------------------------------------
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://frontend:3000

# --- Object storage (MinIO) ------------------------------------------------
MINIO_ROOT_USER=treaz_minio_admin
MINIO_ROOT_PASSWORD=treaz_minio_secret
STORAGE_DRIVER=s3
STORAGE_LOCAL_ROOT=./var/storage
STORAGE_ENDPOINT=http://minio:9000
STORAGE_REGION=us-east-1
STORAGE_FORCE_PATH_STYLE=true
STORAGE_ACCESS_KEY=treaz_minio_admin
STORAGE_SECRET_KEY=treaz_minio_secret
STORAGE_BUCKET_ASSETS=treaz-assets
STORAGE_BUCKET_ROMS=treaz-roms
STORAGE_BUCKET_BIOS=treaz-bios
STORAGE_SIGNED_URL_TTL=900
ROM_UPLOAD_MAX_BYTES=1073741824
USER_AVATAR_MAX_BYTES=5242880

# --- Gameplay state --------------------------------------------------------
PLAY_STATE_MAX_BYTES=1048576
PLAY_STATE_MAX_PER_ROM=5

# --- ScreenScraper integration (leave blank when unused) -------------------
SCREENSCRAPER_USERNAME=
SCREENSCRAPER_PASSWORD=
SCREENSCRAPER_SECRET_KEY=
SCREENSCRAPER_DEV_ID_ENC=
SCREENSCRAPER_DEV_PASSWORD_ENC=
SCREENSCRAPER_BASE_URL=https://www.screenscraper.fr/api2
SCREENSCRAPER_REQUESTS_PER_MINUTE=30
SCREENSCRAPER_CONCURRENCY=2
SCREENSCRAPER_TIMEOUT_MS=15000
SCREENSCRAPER_DEFAULT_LANGUAGE_PRIORITY=en,fr
SCREENSCRAPER_DEFAULT_REGION_PRIORITY=us,eu,wor,jp
SCREENSCRAPER_DEFAULT_MEDIA_TYPES=box-2D,box-3D,wheel,marquee,screenshot,titlescreen
SCREENSCRAPER_ONLY_BETTER_MEDIA=true
SCREENSCRAPER_MAX_ASSETS_PER_TYPE=3

# --- Frontend --------------------------------------------------------------
NEXT_PUBLIC_API_BASE_URL=http://localhost:3001
NEXT_PUBLIC_PIXEL_THEME=monkey-island
NEXT_PUBLIC_MEDIA_CDN=http://minio:9000/treaz-assets
NEXT_TELEMETRY_DISABLED=1

# --- Metrics & Observability ----------------------------------------------
METRICS_ENABLED=true
METRICS_TOKEN=treaz-metrics-token
METRICS_ALLOWED_CIDRS=127.0.0.1/32,172.16.0.0/12
OBSERVABILITY_CSP_ENDPOINT=
OBSERVABILITY_CSP_TOKEN=

# --- Monitoring stack ------------------------------------------------------
GRAFANA_ADMIN_USER=treaz-grafana
GRAFANA_ADMIN_PASSWORD=treaz-grafana-secret

# --- Miscellaneous ---------------------------------------------------------
NGINX_SERVER_NAME=treazrisland.localhost
LETSENCRYPT_PRIMARY_DOMAIN=treazrisland.example.com
LETSENCRYPT_ADDITIONAL_DOMAINS=www.treazrisland.example.com
LETSENCRYPT_EMAIL=admin@example.com
LETSENCRYPT_STAGING=true
CLOUDFLARE_TUNNEL_TOKEN=
