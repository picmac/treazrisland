version: '3.9'

# This override file is not loaded automatically. Copy it to
# `docker-compose.override.yml` and tweak it to suit your local setup.
services:
  frontend:
    environment:
      VITE_API_BASE_URL: http://localhost:4000
    ports:
      - '5173:5173'
    volumes:
      - ../../frontend:/app

  backend:
    environment:
      DATABASE_URL: postgresql://treazr:treazr@localhost:5432/treazr
      JWT_SECRET: change_me_in_local_dev_and_keep_it_long
      OBJECT_STORAGE_ACCESS_KEY: local_dev_access_key
      OBJECT_STORAGE_SECRET_KEY: local_dev_secret_key
    ports:
      - '4000:4000'
    volumes:
      - ../../backend:/app

  postgres:
    ports:
      - '5433:5432'
    environment:
      POSTGRES_PASSWORD: local_dev_password

  redis:
    ports:
      - '6379:6379'

  minio:
    environment:
      MINIO_ROOT_USER: localminio
      MINIO_ROOT_PASSWORD: localminiosecret
    ports:
      - '9000:9000'
      - '9001:9001'

  emulator:
    environment:
      LOCALSTACK_SERVICES: sns,sqs,lambda
    ports:
      - '4566:4566'
